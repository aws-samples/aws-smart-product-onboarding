{
  "name": "amzn-smart-product-onboarding-metaclasses",
  "root": "packages/smart-product-onboarding/metaclasses",
  "tags": ["python"],
  "targets": {
    "install": {
      "dependsOn": ["^install"],
      "executor": "nx:run-commands",
      "options": {
        "command": "poetry env use python$(pyenv latest 3 | cut -d '.' -f 1,2 || echo '') && poetry check --lock && poetry install",
        "cwd": "packages/smart-product-onboarding/metaclasses",
        "env": {
          "VIRTUAL_ENV": "$(env -u VIRTUAL_ENV poetry env info -p || echo '')",
          "PATH": "$(echo $(env -u VIRTUAL_ENV poetry env info -p || echo '')/bin:$PATH)"
        }
      }
    },
    "update": {
      "executor": "nx:run-commands",
      "options": {
        "command": "poetry env use python$(pyenv latest 3 | cut -d '.' -f 1,2 || echo '') && poetry update",
        "cwd": "packages/smart-product-onboarding/metaclasses",
        "env": {
          "VIRTUAL_ENV": "$(env -u VIRTUAL_ENV poetry env info -p || echo '')",
          "PATH": "$(echo $(env -u VIRTUAL_ENV poetry env info -p || echo '')/bin:$PATH)"
        }
      }
    },
    "test": {
      "dependsOn": ["install"],
      "executor": "nx:run-commands",
      "options": {
        "command": "poetry run pytest",
        "cwd": "packages/smart-product-onboarding/metaclasses",
        "env": {
          "VIRTUAL_ENV": "$(env -u VIRTUAL_ENV poetry env info -p || echo '')",
          "PATH": "$(echo $(env -u VIRTUAL_ENV poetry env info -p || echo '')/bin:$PATH)"
        }
      },
      "inputs": [
        "{projectRoot}/**/*.py",
        "{projectRoot}/pyproject.toml",
        "{projectRoot}/poetry.lock",
        "!{projectRoot}/dist/**/*"
      ],
      "outputs": ["{projectRoot}/.pytest_cache"]
    },
    "package": {
      "dependsOn": ["install"],
      "executor": "nx:run-commands",
      "options": {
        "command": "poetry build",
        "cwd": "packages/smart-product-onboarding/metaclasses",
        "env": {
          "VIRTUAL_ENV": "$(env -u VIRTUAL_ENV poetry env info -p || echo '')",
          "PATH": "$(echo $(env -u VIRTUAL_ENV poetry env info -p || echo '')/bin:$PATH)"
        }
      },
      "inputs": [
        "{projectRoot}/**/*.py",
        "{projectRoot}/pyproject.toml",
        "{projectRoot}/poetry.lock",
        "!{projectRoot}/dist/**/*"
      ],
      "outputs": ["{projectRoot}/dist"]
    },
    "build": {
      "dependsOn": ["test", "package"],
      "executor": "nx:run-commands",
      "options": {
        "command": "echo 'Build completed successfully'",
        "cwd": "packages/smart-product-onboarding/metaclasses"
      }
    },
    "publish:test": {
      "dependsOn": ["package"],
      "executor": "nx:run-commands",
      "options": {
        "command": "poetry publish -r testpypi",
        "cwd": "packages/smart-product-onboarding/metaclasses",
        "env": {
          "VIRTUAL_ENV": "$(env -u VIRTUAL_ENV poetry env info -p || echo '')",
          "PATH": "$(echo $(env -u VIRTUAL_ENV poetry env info -p || echo '')/bin:$PATH)"
        }
      }
    },
    "publish": {
      "dependsOn": ["package"],
      "executor": "nx:run-commands",
      "options": {
        "command": "poetry publish",
        "cwd": "packages/smart-product-onboarding/metaclasses",
        "env": {
          "VIRTUAL_ENV": "$(env -u VIRTUAL_ENV poetry env info -p || echo '')",
          "PATH": "$(echo $(env -u VIRTUAL_ENV poetry env info -p || echo '')/bin:$PATH)"
        }
      }
    }
  },
  "implicitDependencies": [
    "amzn-smart-product-onboarding-core-utils",
    "amzn-smart-product-onboarding-api-python-runtime"
  ]
}
