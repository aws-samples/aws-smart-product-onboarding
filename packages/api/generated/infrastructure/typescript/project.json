{
  "name": "@aws-samples/smart-product-onboarding-api-typescript-infra",
  "root": "packages/api/generated/infrastructure/typescript",
  "targets": {
    "generate": {
      "executor": "nx:run-commands",
      "options": {
        "commands": [
          "npx --yes -p @aws/pdk@$AWS_PDK_VERSION type-safe-api generate --specPath ../../../model/.api.json --outputPath . --templateDirs \"typescript-cdk-infrastructure\" --metadata '{\"srcDir\":\"src\",\"runtimePackageName\":\"@aws-samples/smart-product-onboarding-api-typescript-runtime\",\"relativeSpecPath\":\"../assets/api.json\",\"enableMockIntegrations\":true,\"x-handlers-python-module\":\"amzn_smart_product_onboarding_api_python_handlers\",\"x-handlers-java-package\":\"\",\"x-handlers-typescript-asset-path\":\"../../../handlers/typescript/dist/lambda\",\"x-handlers-python-asset-path\":\"../../../handlers/python/dist/lambda\",\"x-handlers-java-asset-path\":\"\",\"x-handlers-node-lambda-runtime-version\":\"NODEJS_22_X\",\"x-handlers-python-lambda-runtime-version\":\"PYTHON_3_13\",\"x-handlers-java-lambda-runtime-version\":\"\"}'",
          "mkdir -p assets",
          "cp -f ../../../model/.api.json assets/api.json",
          "npx --yes -p @aws/pdk@$AWS_PDK_VERSION type-safe-api generate-mock-data --specPath ../../../model/.api.json --outputPath ."
        ],
        "cwd": "packages/api/generated/infrastructure/typescript",
        "parallel": false
      },
      "env": {
        "AWS_PDK_VERSION": "0.26.7"
      },
      "dependsOn": ["@aws-samples/smart-product-onboarding-api-model:generate"]
    },
    "compile": {
      "executor": "nx:run-commands",
      "options": {
        "command": "tsc --build",
        "cwd": "packages/api/generated/infrastructure/typescript"
      },
      "inputs": [
        "default",
        "^default",
        "{projectRoot}/src/**/*",
        "{projectRoot}/tsconfig.json"
      ],
      "outputs": ["{projectRoot}/lib"],
      "dependsOn": [
        "generate",
        "@aws-samples/smart-product-onboarding-api-typescript-runtime:compile"
      ]
    },
    "watch": {
      "executor": "nx:run-commands",
      "options": {
        "command": "tsc --build -w",
        "cwd": "packages/api/generated/infrastructure/typescript"
      }
    },
    "test": {
      "executor": "nx:run-commands",
      "options": {
        "command": "echo 'No tests defined for generated infrastructure package'"
      }
    },
    "package": {
      "executor": "nx:run-commands",
      "options": {
        "commands": [
          "mkdir -p dist/js",
          "pnpm pack --pack-destination dist/js"
        ],
        "cwd": "packages/api/generated/infrastructure/typescript",
        "parallel": false
      },
      "inputs": ["{projectRoot}/lib/**/*", "{projectRoot}/package.json"],
      "outputs": ["{projectRoot}/dist"],
      "dependsOn": ["compile"]
    },
    "build": {
      "dependsOn": ["generate", "compile", "test", "package"]
    }
  },
  "implicitDependencies": [
    "@aws-samples/smart-product-onboarding-api-typescript-runtime",
    "@aws-samples/smart-product-onboarding-api-model"
  ]
}
