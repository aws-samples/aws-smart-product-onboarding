{
  "name": "@aws-samples/smart-product-onboarding-infra",
  "root": "packages/infra",
  "targets": {
    "compile": {
      "executor": "nx:run-commands",
      "options": {
        "command": "tsc --build",
        "cwd": "packages/infra"
      },
      "inputs": ["{projectRoot}/src/**/*.ts", "{projectRoot}/tsconfig.json"],
      "outputs": ["{projectRoot}/lib"]
    },
    "test": {
      "executor": "nx:run-commands",
      "options": {
        "commands": [
          "jest --passWithNoTests --updateSnapshot",
          "eslint --ext .ts,.tsx --fix --no-error-on-unmatched-pattern src test"
        ],
        "cwd": "packages/infra",
        "parallel": false
      },
      "inputs": [
        "{projectRoot}/src/**/*.ts",
        "{projectRoot}/test/**/*.ts",
        "{projectRoot}/tsconfig.dev.json"
      ],
      "outputs": ["{projectRoot}/coverage", "{projectRoot}/test-reports"],
      "dependsOn": ["compile"]
    },
    "lint": {
      "executor": "nx:run-commands",
      "options": {
        "command": "eslint --ext .ts,.tsx --fix --no-error-on-unmatched-pattern src test",
        "cwd": "packages/infra"
      },
      "inputs": [
        "{projectRoot}/src/**/*.ts",
        "{projectRoot}/test/**/*.ts",
        "{projectRoot}/.eslintrc.json"
      ]
    },
    "bootstrap": {
      "executor": "nx:run-commands",
      "options": {
        "command": "cdk bootstrap",
        "cwd": "packages/infra"
      },
      "dependsOn": [
        "@aws-samples/smart-product-onboarding-api-typescript-handlers:build",
        "amzn-smart-product-onboarding-api-python-handlers:build",
        "amzn-smart-product-onboarding-core-utils:build",
        "amzn-smart-product-onboarding-product-categorization:build",
        "amzn-smart-product-onboarding-metaclasses:build",
        "compile"
      ]
    },
    "synth": {
      "executor": "nx:run-commands",
      "options": {
        "command": "cdk synth",
        "cwd": "packages/infra"
      },
      "dependsOn": [
        "@aws-samples/smart-product-onboarding-api-typescript-handlers:build",
        "amzn-smart-product-onboarding-api-python-handlers:build",
        "amzn-smart-product-onboarding-core-utils:build",
        "amzn-smart-product-onboarding-product-categorization:build",
        "amzn-smart-product-onboarding-metaclasses:build",
        "compile"
      ]
    },
    "synth:silent": {
      "executor": "nx:run-commands",
      "options": {
        "command": "cdk synth -q",
        "cwd": "packages/infra"
      },
      "dependsOn": [
        "@aws-samples/smart-product-onboarding-api-typescript-handlers:build",
        "amzn-smart-product-onboarding-api-python-handlers:build",
        "amzn-smart-product-onboarding-core-utils:build",
        "amzn-smart-product-onboarding-product-categorization:build",
        "amzn-smart-product-onboarding-metaclasses:build",
        "compile"
      ]
    },
    "deploy": {
      "executor": "nx:run-commands",
      "options": {
        "command": "cdk deploy --require-approval never",
        "cwd": "packages/infra"
      },
      "dependsOn": ["synth"]
    },
    "deploy:dev": {
      "executor": "nx:run-commands",
      "options": {
        "command": "cdk deploy --hotswap-fallback --require-approval never",
        "cwd": "packages/infra"
      },
      "dependsOn": ["synth"]
    },
    "destroy": {
      "executor": "nx:run-commands",
      "options": {
        "command": "cdk destroy",
        "cwd": "packages/infra"
      }
    },
    "diff": {
      "executor": "nx:run-commands",
      "options": {
        "command": "cdk diff",
        "cwd": "packages/infra"
      },
      "dependsOn": ["synth"]
    },
    "watch": {
      "executor": "nx:run-commands",
      "options": {
        "commands": ["cdk deploy --hotswap", "cdk watch"],
        "cwd": "packages/infra",
        "parallel": false
      },
      "dependsOn": [
        "@aws-samples/smart-product-onboarding-api-typescript-handlers:build",
        "amzn-smart-product-onboarding-api-python-handlers:build",
        "amzn-smart-product-onboarding-core-utils:build",
        "amzn-smart-product-onboarding-product-categorization:build",
        "amzn-smart-product-onboarding-metaclasses:build"
      ]
    },
    "build": {
      "executor": "nx:run-commands",
      "options": {
        "commands": [
          "nx run @aws-samples/smart-product-onboarding-infra:compile",
          "nx run @aws-samples/smart-product-onboarding-infra:post-compile",
          "nx run @aws-samples/smart-product-onboarding-infra:test",
          "nx run @aws-samples/smart-product-onboarding-infra:package"
        ],
        "cwd": "packages/infra",
        "parallel": false
      },
      "dependsOn": ["^build"]
    },
    "test:watch": {
      "executor": "nx:run-commands",
      "options": {
        "command": "jest --watch",
        "cwd": "packages/infra"
      }
    }
  }
}
